<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">dist/main/externalApis/weather.js | potts-reborn</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">dist/main/externalApis/weather.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&quot;use strict&quot;;
var __importDefault = (this &amp;&amp; this.__importDefault) || function (mod) {
    return (mod &amp;&amp; mod.__esModule) ? mod : { &quot;default&quot;: mod };
};
Object.defineProperty(exports, &quot;__esModule&quot;, { value: true });
const forecast_1 = __importDefault(require(&quot;forecast&quot;));
const environment_1 = require(&quot;../environment&quot;);
const WHITE_HAVEN_LAT = 1.28891123;
const WHITE_HAVEN_LONG = 103.7768478;
// clear-day, clear-night, rain, snow, sleet, wind, fog, cloudy, partly-cloudy-day, or partly-cloudy-night
const MAP_ICON_TO_PICTURE = {
    &apos;clear-day&apos;: &apos;1018927418276670&apos;,
    &apos;clear-night&apos;: &apos;1018928791609866&apos;,
    &apos;rain&apos;: &apos;1018929591609786&apos;,
    &apos;snow&apos;: &apos;1018930251609720&apos;,
    &apos;sleet&apos;: &apos;1018930598276352&apos;,
    &apos;wind&apos;: &apos;1018930828276329&apos;,
    &apos;fog&apos;: &apos;1018931048276307&apos;,
    &apos;cloudy&apos;: &apos;1018931408276271&apos;,
    &apos;partly-cloudy-day&apos;: &apos;1018932811609464&apos;,
    &apos;partly-cloudy-night&apos;: &apos;1018933201609425&apos;,
};
if (!environment_1.DARKSKY_KEY) {
    throw new Error(&apos;missing DARKSKY_KEY&apos;);
}
// Initialize
const forecast = new forecast_1.default({
    service: &apos;darksky&apos;,
    key: environment_1.DARKSKY_KEY,
    units: &apos;celcius&apos;,
    cache: true,
    ttl: {
        // How long to cache requests. Uses syntax from moment.js: http://momentjs.com/docs/#/durations/creating/
        minutes: 27,
        seconds: 45,
    },
});
/**
 * Return weather object based on coordinate
 * @param {Coordinate} coordinate
 */
const getWeather = (coordinate) =&gt; {
    return new Promise((response, reject) =&gt; {
        forecast.get(coordinate, (err, weather) =&gt; {
            if (err) {
                reject(err);
            }
            else {
                response(weather);
            }
        });
    });
};
exports.getWeather = getWeather;
const getWeatherMessage = (...params) =&gt; {
    return new Promise((response, reject) =&gt; {
        const coordinate = params.length === 2 ? [params[0], params[1]] : [WHITE_HAVEN_LAT, WHITE_HAVEN_LONG];
        getWeather(coordinate)
            .then((weather) =&gt; {
            response({
                current: `It&apos;s ${weather.currently.summary.toLowerCase()}  near your house now! `,
                summary: `In general, it is ${weather.hourly.summary.toLowerCase()} and this week there is ${weather.daily.summary.toLowerCase()}`,
                imageId: MAP_ICON_TO_PICTURE[weather.currently.icon],
            });
        })
            .catch((err) =&gt; reject(err));
    });
};
exports.getWeatherMessage = getWeatherMessage;
//# sourceMappingURL=weather.js.map</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
